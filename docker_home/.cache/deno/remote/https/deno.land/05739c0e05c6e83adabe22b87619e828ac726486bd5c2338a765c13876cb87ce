// Ported from js-yaml v3.13.1:
// https://github.com/nodeca/js-yaml/commit/665aadda42349dcae869f12040d9b10ef18d12da
// Copyright 2011-2015 by Vitaly Puzrin. All rights reserved. MIT license.
// Copyright 2018-2022 the Deno authors. All rights reserved. MIT license.

import type { Any, ArrayObject } from "./utils.ts";

export type KindType = "sequence" | "scalar" | "mapping";
export type StyleVariant = "lowercase" | "uppercase" | "camelcase" | "decimal";
export type RepresentFn = (data: Any, style?: StyleVariant) => Any;

const DEFAULT_RESOLVE = (): boolean => true;
const DEFAULT_CONSTRUCT = (data: Any): Any => data;

interface TypeOptions {
  kind: KindType;
  resolve?: (data: Any) => boolean;
  construct?: (data: string) => Any;
  instanceOf?: Any;
  predicate?: (data: Record<string, unknown>) => boolean;
  represent?: RepresentFn | ArrayObject<RepresentFn>;
  defaultStyle?: StyleVariant;
  styleAliases?: ArrayObject;
}

function checkTagFormat(tag: string): string {
  return tag;
}

export class Type {
  public tag: string;
  public kind: KindType | null = null;
  public instanceOf: Any;
  public predicate?: (data: Record<string, unknown>) => boolean;
  public represent?: RepresentFn | ArrayObject<RepresentFn>;
  public defaultStyle?: StyleVariant;
  public styleAliases?: ArrayObject;
  public loadKind?: KindType;

  constructor(tag: string, options?: TypeOptions) {
    this.tag = checkTagFormat(tag);
    if (options) {
      this.kind = options.kind;
      this.resolve = options.resolve || DEFAULT_RESOLVE;
      this.construct = options.construct || DEFAULT_CONSTRUCT;
      this.instanceOf = options.instanceOf;
      this.predicate = options.predicate;
      this.represent = options.represent;
      this.defaultStyle = options.defaultStyle;
      this.styleAliases = options.styleAliases;
    }
  }
  public resolve: (data?: Any) => boolean = (): boolean => true;
  public construct: (data?: Any) => Any = (data): Any => data;
}

// denoCacheMetadata={"headers":{"cache-control":"public, max-age=31536000, immutable","server":"deno/gcp-us-east4","server-timing":"fetchSource;dur=12","via":"http/2 edgeproxy-h","x-content-type-options":"nosniff","x-amz-replication-status":"COMPLETED","content-length":"1963","cross-origin-opener-policy":"same-origin","strict-transport-security":"max-age=63072000; includeSubDomains; preload","content-type":"application/typescript; charset=utf-8","referrer-policy":"strict-origin-when-cross-origin","content-security-policy":"default-src 'none'; style-src 'unsafe-inline'; sandbox","last-modified":"Wed, 14 Dec 2022 22:35:43 GMT","x-amz-cf-pop":"IAD61-P1","x-amz-server-side-encryption":"AES256","x-amz-version-id":"lJEp7MtDZCMXC5x69gfIyJSkX9TllTVV","x-amz-cf-id":"Zlm5lNV2cKDWK5oYjavcT09Lq1ld-cGcUYwGttJb69a6YHjjJh5oBQ==","accept-ranges":"bytes","x-cache":"Hit from cloudfront","cross-origin-embedder-policy":"same-origin","date":"Sun, 06 Apr 2025 04:46:06 GMT","vary":"Accept-Encoding, Origin","x-frame-options":"DENY","cross-origin-resource-policy":"same-origin","etag":"\"4b57592c81a860027da169949f0be74b\"","access-control-allow-origin":"*","age":"10149612"},"url":"https://deno.land/std@0.168.0/encoding/_yaml/type.ts","time":1754064377}