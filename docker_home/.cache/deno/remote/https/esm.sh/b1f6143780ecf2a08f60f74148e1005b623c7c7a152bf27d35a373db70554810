/* esm.sh - github:jeff-hykin/good-js#f6d5bcb/source/iterable */
var m=function(t){return t!=null&&typeof t[Symbol.asyncIterator]=="function"};var x=class{};try{x=eval("(async function(){}).constructor")}catch(t){}var F=function(t){return t instanceof Object&&typeof t[Symbol.iterator]=="function"};function _(){let t,o="pending",n,r=new Promise((e,i)=>{t={resolve(s){o==="pending"&&Promise.resolve(s).then(l=>{o="fulfilled",e(l)}).catch((...l)=>{o="rejected",i(...l)})},reject(s){o==="pending"&&(o="rejected",i(s))},[Symbol.iterator](){throw Error("You're trying to sync-iterate over a promise")}}});return Object.defineProperty(r,"state",{get:()=>o}),Object.assign(r,t)}var g=function*(){}();g.length=0;var C=class{};try{C=eval("(async function*(){}).constructor")}catch(t){}var M=class{};try{M=eval("(function*(){}).constructor")}catch(t){}var h=t=>{if(t==null)return g;if(typeof t[Symbol.iterator]=="function"||typeof t[Symbol.asyncIterator]=="function")return t;if(typeof t?.next=="function"){let o=t?.next instanceof x,n;o?n={[Symbol.asyncIterator](){return t},...t}:n={[Symbol.iterator](){return t},[Symbol.asyncIterator](){return t},...t};for(let[r,e]of Object.entries(t))typeof e=="function"&&(n[r]=e.bind(t));return n}return typeof t=="function"?t():Object.getPrototypeOf(t).constructor==Object?Object.entries(t):g};var S=Symbol.for("iterationStop");var p=t=>{if(typeof t?.next=="function")return t;if(t==null)return g;if(typeof t[Symbol.iterator]=="function"){let o=t[Symbol.iterator]();return Number.isFinite(o?.length)||(Number.isFinite(t?.length)?o.length=t.length:Number.isFinite(t?.size)&&(o.length=t.size)),o}else if(typeof t[Symbol.asyncIterator]=="function"){let o=t[Symbol.asyncIterator]();return Number.isFinite(o?.length)||(Number.isFinite(t?.length)?o.length=t.length:Number.isFinite(t?.size)&&(o.length=t.size)),o}else{if(typeof t=="function")return t();if(Object.getPrototypeOf(t).constructor==Object){let o=Object.entries(t),n=o[Symbol.iterator]();return n.length=o.length,n}}return g};var R=({value:t,done:o})=>o?S:t,O=t=>{if(t.next instanceof Function){let o=t.next();return o instanceof Promise?o.then(R):R(o)}else throw Error("can't call next(object) on the following object as there is no object.next() method",t)};function T(t,o){t=h(t);let n;return m(t)?n=async function*(){let r=-1;for await(let e of t)yield await o(e,++r)}():n=function*(){let r=-1;for(let e of t)yield o(e,++r)}(),typeof t.size=="number"&&(n.length=t.size),typeof t.length=="number"&&(n.length=t.length),n}function q(t,o){t=h(t);let n;return m(t)||o instanceof x?n=async function*(){let r=-1;for await(let e of t)await o(e,++r)&&(yield e)}():n=function*(){let r=-1;for(let e of t)o(e,++r)&&(yield e)}(),n}function B(...t){t=t.map(h);let o;if(t.some(m)?o=async function*(){for(let n of t)for await(let r of n)yield r}():o=function*(){for(let n of t)yield*n}(),t.every(n=>typeof n.length=="number"&&n.length===n.length)){let n=0;for(let r of t)n+=r.length;o.length=n}return o}function Z(t,o){t=h(t);let n;if(m(t)||o instanceof x)return async function(){let r=-1,e;for await(let i of t)r++,r==-1?e=await o(i,r):e=await o(i,r,e);return e}();{let r=-1,e;for(let i of t)r++,r==-1?e=o(i,r):e=o(i,r,e);return e}}function j({iterable:t,depth:o=1/0,asyncsInsideSyncIterable:n=!1}){return o<=0?t:(t=h(t),m(t)||n?async function*(){for await(let r of t)if(m(r)||F(r))for await(let e of j({iterable:r,depth:o-1,asyncsInsideSyncIterable:n}))yield e;else yield r}():function*(){for(let r of t)if(F(r))for(let e of j({iterable:r,depth:o-1}))yield e;else yield r}())}function w(t){let o=_(),n;try{n=p(t),Number.isFinite(n?.length)&&(o.length=n.length)}catch(i){return o.reject(i),o}o[Symbol.asyncIterator]=()=>n;let r=[],e=()=>{let i;try{i=n.next()}catch(s){o.reject(s);return}if(i==null){o.reject(Error("When iterating over an async iterator, the .next() returned null/undefined"));return}if(typeof i.then!="function"){let{value:s,done:l}=i;l?o.resolve(r):(r.push(s),e());return}i.catch(o.reject),i.then(({value:s,done:l})=>{l?o.resolve(r):(r.push(s),e())})};o.results=r;try{e()}catch(i){o.reject(i)}return o}function V(t){let o=t instanceof Array||typeof t=="string",n=t instanceof Set;if(o||n){let r=o?t.length:t.size,e=r,i=function*(){for(;e>0;)yield t[--e]}();return i.length=r,i}return m(t)?w(t).then(r=>reversed(r)):[...t].reverse()}function A(t,o={_prevPromise:null}){let{_prevPromise:n}=o;t=h(t);let r={then:null,catch:null,finally:null},e=_();return delete e[Symbol.iterator],m(t)?e[Symbol.asyncIterator]=()=>{let i=p(t),s=-1,l=!1,f=!1,a=async(c,u,y)=>{if(!f){f=!0,r.finally&&await r.finally();let d=!1;try{await n}catch(I){d=!0,e.reject(I)}d||(u?e.reject(u):e.resolve(c))}};return{async next(){let c={value:null,done:!0};s++;try{c=await i.next()}catch(u){if(l=u,!r.catch)c.reject(u);else try{await r.catch(u,s),l=void 0,c.done=!0}catch(y){c.reject(y)}}finally{if(c.done){if(!l){let u;try{u=await(r.then&&r.then(s))}catch(y){throw l=y,y}finally{a(u,l,s)}}a(void 0,l,s)}}return c}}}:e[Symbol.iterator]=()=>{let i=p(t),s=-1,l=!1,f=!1,a=async(c,u,y)=>{if(!f){f=!0,r.finally&&await r.finally();let d=!1;try{await n}catch(I){d=!0,e.reject(I)}d||(u?e.reject(c):e.resolve(c))}};return{next(){let c={value:null,done:!0};s++;try{c=i.next()}catch(u){l=!0;let y=!1;try{return r.catch&&r.catch(u,s),{done:!0}}catch(d){y=!0,c.reject(d)}throw y||c.reject(u),u}finally{if(c.done){if(!l){let u;try{u=r.then&&r.then(s)}finally{a(u,l,s)}}a(void 0,l,s)}}return c}}},Object.assign(e,{then(i){return r.then=i,A(e,{_prevPromise:e})},catch(i){return r.catch=i,A(e,{_prevPromise:e})},finally(i){return r.finally=i,A(e,{_prevPromise:e})}}),typeof t.length=="number"&&t.length===t.length&&(e.length=t.length),e}function z({data:t,filters:o,outputArrays:n=!1}){let r=m(t),e={},i=p(t);for(let[s,l]of Object.entries(o)){let f=[],a=0;r||l instanceof x?e[s]=new b(async function*(){for(;;){if(e[s].hitError)throw e[s].hitError;if(f.length==0){let c=await O(i);if(c==S)break;for(let[u,y]of Object.entries(e)){let d=!1;try{d=await y.check(c,a++)}catch(I){y.hitError=I}d&&y.que.push(c)}}f.length!=0&&(yield f.shift())}}()):e[s]=new b(function*(){for(;;){if(e[s].hitError)throw e[s].hitError;if(f.length==0){let c=O(i);if(c==S)break;for(let[u,y]of Object.entries(e)){let d=!1;try{d=y.check(c,a++)}catch(I){y.hitError=I}d&&y.que.push(c)}}f.length!=0&&(yield f.shift())}}()),e[s].check=l,e[s].hitError=!1,e[s].que=f}if(n)for(let[s,l]of Object.entries(e))m(l)?e[s]=w(l):e[s]=[...l];return e}function b(t,o={length:null,_createEmpty:!1}){let{length:n,_createEmpty:r}={length:null,_createEmpty:!1,...o};if(r)return this;let e=this===void 0||this===globalThis?new b(null,{_createEmpty:!0}):this;return t instanceof Array?e.length=t.length:t instanceof Set?e.length=t.size:typeof n=="number"&&(e.length=n),e._source=h(t),e._source[Symbol.iterator]&&(e[Symbol.iterator]=e._source[Symbol.iterator].bind(e._source)),e._source[Symbol.asyncIterator]&&(e[Symbol.asyncIterator]=e._source[Symbol.asyncIterator].bind(e._source)),e[Symbol.isConcatSpreadable]=!0,e.lengthIs=function(i){return e.length=i,e},e.map=function(i){let s={...e._source,[Symbol.iterator]:()=>{let f=p(e._source),a=0;return{next(){let{value:c,done:u}=f.next();return{value:u||i(c,a++),done:u}}}}};return(m(e._source)||i instanceof x)&&(s[Symbol.asyncIterator]=()=>{let f=p(e._source),a=0;return{async next(){let{value:c,done:u}=await f.next();return{value:u||await i(c,a++),done:u}}}}),new b(s)},e.filter=function(i){let s={...e._source,[Symbol.iterator]:()=>{let f=p(e._source),a=0;return{next(){for(;;){let c=f.next();if(c.done||i(c.value,a++))return c}}}}};return(m(e._source)||i instanceof x)&&(s[Symbol.asyncIterator]=()=>{let f=p(e._source),a=0;return{async next(){for(;;){let c=await f.next();if(c.done||await i(c.value,a++))return c}}}}),new b(s)},e.forkBy=({...i},...s)=>z({...i,data:e},...s),e.flat=(i=1,s=!1)=>new b(j({iterable:e,depth:i,asyncsInsideSyncIterable:s})),e.then=i=>{let s={...e._source,[Symbol.iterator]:()=>{let f=p(e._source),a=-1;return{next(){let c=f.next();return a++,c.done&&i(e,a),c}}}};return m(e._source)&&(s[Symbol.asyncIterator]=()=>{let f=p(e._source),a=-1;return{async next(){let c=await f.next();return a++,c.done&&await i(e,a),c}}}),new b(s)},e.finally=i=>{let s={...e._source,[Symbol.iterator]:()=>{let f=p(e._source),a=-1;return{next(){let c={value:null,done:!0};try{c=f.next(),a++}finally{c.done&&i(e,a)}}}}};return m(e._source)&&(s[Symbol.asyncIterator]=()=>{let f=p(e._source),a=0;return{async next(){let c={value:null,done:!0};try{c=await f.next(),a++}finally{c.done&&await i(e,a)}}}}),new b(s)},Object.defineProperties(e,{toArray:{get(){return e[Symbol.asyncIterator]?(async()=>{let i=e[Symbol.asyncIterator](),s=[];for(;;){let{value:l,done:f}=await i.next();if(f)break;s.push(l)}return s})():[...e]}},flattened:{get(){return e.flat(1/0)}}}),e}var W=function*(...t){let o=t.map(p);for(;;){let n=o.map(r=>r.next());if(n.every(r=>r.done))break;yield n.map(r=>r.value)}},P=function(...t){let o=W(...t),n=Math.max(...t.map(r=>typeof r!="function"&&(typeof r?.length=="number"?r?.length:r.size)));return n==n&&(o.length=n),o};var E=function*({start:t=0,end:o=1/0,step:n=1}){let r=t;for(;r<=o;)yield r,r+=n};var H=function*(...t){let o=0;for(let n of P(...t))yield[o++,...n]};var D=function*(t){yield t.slice();let o=t.length,n=new Array(o).fill(0),r=1,e,i;for(;r<o;)n[r]<r?(e=r%2&&n[r],i=t[r],t[r]=t[e],t[e]=i,++n[r],r=1,yield t.slice()):(n[r]=0,++r)};var k=function*(t,o,n){if(o===n&&n===void 0?(n=1,o=t.length):(o=o||t.length,n=n===void 0?o:n),n!==o)for(let r=n;r<=o;r++)yield*k(t,r,r);else if(o===1)yield*t.map(r=>[r]);else for(let r=0;r<t.length;r++)for(let e of k(t.slice(r+1,t.length),o-1,o-1))yield[t[r],...e]};var Y=function*(t){let o=E({start:1,end:numberOfPartitions.length-1});for(let n of k(o)){n.sort();let r=0,e=[];for(let i of[...n,t.length])e.push(t.slice(r,i)),r=i;yield e}};function v(t,{valueToKey:o=null,sort:n=!1}={}){if(t=h(t),o=o||(r=>r),m(t))return async function(){let r=new Map;for await(let e of t)e=o(e),r.set(e,(r.get(e)||0)+1);return n?n>0?new Map([...r.entries()].sort((e,i)=>i[1]-e[1])):new Map([...r.entries()].sort((e,i)=>e[1]-i[1])):r}();{let r=new Map;for(let e of t)e=o(e),r.set(e,(r.get(e)||0)+1);return n?n>0?new Map([...r.entries()].sort((e,i)=>i[1]-e[1])):new Map([...r.entries()].sort((e,i)=>e[1]-i[1])):r}}var N="Threw while mapping";function G({iterator:t,transformFunction:o,poolLimit:n=null,awaitAll:r=!1}){n=n||G.defaultPoolLimit;let e=new TransformStream({async transform(l,f){try{let a=await l;f.enqueue(a)}catch(a){a instanceof AggregateError&&a.message==N&&f.error(a)}}}),i=(async()=>{let l=e.writable.getWriter(),f=[];try{let a=0;for await(let c of t){let u=Promise.resolve().then(()=>o(c,a));a++,l.write(u);let y=u.then(()=>f.splice(f.indexOf(y),1));f.push(y),f.length>=n&&await Promise.race(f)}await Promise.all(f),l.close()}catch{let a=[];for(let c of await Promise.allSettled(f))c.status=="rejected"&&a.push(c.reason);l.write(Promise.reject(new AggregateError(a,N))).catch(()=>{})}})(),s=e.readable[Symbol.asyncIterator]();return r?i.then(()=>w(s)):s}G.defaultPoolLimit=40;export{b as Iterable,S as Stop,A as after,w as asyncIteratorToList,k as combinations,B as concat,G as concurrentlyTransform,E as count,g as emptyGeneratorObject,H as enumerate,q as filter,j as flattened,z as forkBy,v as frequencyCount,p as iter,h as makeIterable,T as map,O as next,D as permute,Z as reduce,V as reversed,Y as slices,S as stop,P as zip};
//# sourceMappingURL=iterable.mjs.map
// denoCacheMetadata={"headers":{"date":"Fri, 01 Aug 2025 16:18:13 GMT","access-control-allow-origin":"*","server":"cloudflare","vary":"Accept-Encoding","content-type":"application/javascript; charset=utf-8","cf-cache-status":"HIT","alt-svc":"h3=\":443\"; ma=86400","cf-ray":"9686a671e8b0f0b4-DFW","cache-control":"public, max-age=31536000, immutable","last-modified":"Mon, 21 Jul 2025 21:50:30 GMT","age":"825"},"url":"https://esm.sh/gh/jeff-hykin/good-js@f6d5bcb/denonext/source/iterable.mjs","time":1754065093}